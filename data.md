# Copilot Studio エージェント構築ガイド

## 1. エージェント基本設定

### **エージェント名**
`コールセンタースクリプトアシスタント`

### **エージェントの説明**
```
コールセンターオペレーター向けに、顧客のケースに応じた最適なトークスクリプトを動的に生成するAIアシスタントです。ケース情報を入力すると、段階的で効果的な応対スクリプトをアダプティブカードで提供します。
```

### **システム指示（Instructions）**
```
あなたはコールセンターオペレーター専用のトークスクリプト生成アシスタントです。

## 役割と目的
- オペレーターが入力したケース情報を分析し、最適なトークスクリプトを生成する
- 段階的で実践的な応対フローを提供する
- 顧客の感情や状況に配慮した適切な表現を提案する
- アダプティブカードで視覚的に分かりやすく情報を整理する

## 応答の原則
1. **段階的アプローチ**: 会話を論理的なステップに分解
2. **感情配慮**: 顧客の感情状態に適した表現を選択
3. **実用性重視**: すぐに使える具体的なフレーズを提供
4. **柔軟性確保**: 複数の選択肢や代替表現を用意
5. **継続支援**: 次のステップや追加支援を常に提案

## 分析すべき要素
- ケースタイプ（クレーム、問い合わせ、注文等）
- 商品・サービス名
- 顧客の感情状態（怒り、困惑、急ぎ等）
- 緊急度・重要度
- 特記事項（過去の履歴、特別な配慮等）

## 出力形式
必ずアダプティブカードを使用し、以下の構造で提供：
- ケース概要の整理
- 推奨応対フロー（3-5段階）
- 各段階での具体的なスクリプト例
- 選択可能なアクション（使用、再生成、次へ）
- 注意点やコツの提示
```

## 2. 会話フロー設計

### **メイントピック構成**

#### **Topic 1: ケース受付・分析**
```yaml
トピック名: "ケース情報入力"
トリガーフレーズ: 
  - "スクリプト作成"
  - "トークスクリプト"
  - "応対支援"
  - "ケース対応"

変数設定:
  - caseType (選択肢: クレーム、問い合わせ、注文、技術サポート、その他)
  - productService (テキスト)
  - customerEmotion (選択肢: 怒り、困惑、急ぎ、普通、喜び)
  - urgencyLevel (選択肢: 緊急、高、中、低)
  - additionalInfo (テキスト)
```

#### **Topic 2: スクリプト生成・提示**
```yaml
トピック名: "スクリプト生成"
条件: ケース情報が揃った時

処理フロー:
1. ケース分析実行
2. 応対フロー決定
3. アダプティブカード生成
4. スクリプト提示
```

#### **Topic 3: スクリプト操作**
```yaml
トピック名: "スクリプト操作"
トリガー: アダプティブカードのアクション

操作種類:
  - use_phrase: フレーズ使用
  - regenerate: 再生成
  - next_step: 次ステップ
  - modify: カスタマイズ
  - feedback: フィードバック
```

### **会話フロー詳細**

#### **初期会話フロー**
```
1. 挨拶・目的確認
   ↓
2. ケース情報収集
   ├─ ケースタイプ選択
   ├─ 商品・サービス名入力
   ├─ 顧客感情状態選択
   ├─ 緊急度選択
   └─ 追加情報入力
   ↓
3. 情報確認・分析
   ↓
4. スクリプト生成・提示
   ↓
5. オペレーター操作対応
   ├─ フレーズ使用
   ├─ 再生成要求
   ├─ 次ステップ要求
   └─ カスタマイズ要求
```

## 3. 具体的な設定手順

### **Step 1: 基本設定**
1. Copilot Studio で新しいエージェント作成
2. 上記のエージェント名・説明・指示を設定
3. 言語設定: 日本語

### **Step 2: 変数定義**
```
Global Variables:
- caseType: Text
- productService: Text  
- customerEmotion: Text
- urgencyLevel: Text
- additionalInfo: Text
- currentPhase: Number
- scriptSteps: Table
```

### **Step 3: トピック作成**

**最初に作成するトピック: "ケース情報入力"**
```yaml
User Input Examples:
  - "スクリプトを作成してください"
  - "ケース対応を支援して"
  - "トークスクリプトが欲しい"

First Message:
"こんにちは！コールセンタースクリプトアシスタントです。
お客様への応対スクリプトを作成いたします。
まず、対応するケースについて教えてください。"

Question Nodes:
1. ケースタイプ選択 (Multiple Choice)
2. 商品・サービス名 (Open-ended)
3. 顧客の感情状態 (Multiple Choice)  
4. 緊急度 (Multiple Choice)
5. 追加情報 (Open-ended, Optional)
```

### **Step 4: アダプティブカード設定**
```json
{
  "type": "AdaptiveCard",
  "version": "1.5",
  "body": [
    {
      "type": "TextBlock", 
      "text": "ケース分析結果",
      "weight": "Bolder",
      "size": "Medium"
    },
    {
      "type": "FactSet",
      "facts": [
        {"title": "ケースタイプ", "value": "${caseType}"},
        {"title": "商品・サービス", "value": "${productService}"},
        {"title": "顧客感情", "value": "${customerEmotion}"},
        {"title": "緊急度", "value": "${urgencyLevel}"}
      ]
    }
  ]
}
```

まずは**ケース情報入力のトピック**から作成していきましょう。Copilot Studioで新しいエージェントを作成し、上記の基本設定を入力してください。

準備ができましたら、次のステップをご案内いたします！


以下のケース情報に基づいて、コールセンターオペレーター向けの段階的トークスクリプトを生成してください。

## ケース情報
- ケースタイプ: {caseType}
- 商品・サービス: {productService}
- 顧客感情: {customerEmotion}  
- 緊急度: {urgencyLevel}

## 出力要件
1. **4つの段階**に分けて構成
   - 第1段階: 挨拶・状況確認
   - 第2段階: 共感・理解表明
   - 第3段階: 解決策提示・説明
   - 第4段階: 確認・クロージング

2. **各段階で以下を提供**:
   - 💬 推奨スクリプト（2-3パターン）
   - ⚠️ 注意点
   - 💡 コツ・ポイント

3. **顧客感情に応じた表現調整**:
   - 怒り→謝罪・共感重視
   - 困惑→分かりやすい説明
   - 急ぎ→簡潔・効率重視
   - 普通→標準的な丁寧語
   - 満足→感謝・継続関係重視

4. **緊急度に応じた対応速度**:
   - 緊急→即座の対応・上席報告準備
   - 高→迅速な解決策提示
   - 中→標準的な対応フロー
   - 低→丁寧で詳細な説明

見やすく構造化された形式で出力してください。

id,type,title,content,icon,category,urgency
START_001,OP,オープニング挨拶,"お忙しい中お電話いただき、ありがとうございます。○○通信カスタマーサポートの△△と申します。本日はどのようなご用件でしょうか？",📞,basic,low
ID_001,ID,本人確認,"ご本人様確認をさせていただきます。恐れ入りますが、お客様番号またはご登録のお電話番号をお教えいただけますでしょうか？",🔐,basic,medium
REQ_001,REQ,要件確認,"ありがとうございます。それでは、具体的にどのようなお困りごとでしょうか？詳しくお聞かせください。",📋,basic,low
NEW_001,INF,新規申込受付,"新規お申込みをご希望ですね。ありがとうございます。どちらのサービスにご興味をお持ちでしょうか？",📝,sales,low
NEW_002,INF,インターネットプラン説明,"弊社では3つのインターネットプランをご用意しております。ベーシック（100Mbps）、スタンダード（500Mbps）、プレミアム（1Gbps）がございます。",🌐,sales,low
NEW_003,INF,電話プラン説明,"固定電話サービスは基本料金1,500円でご利用いただけます。インターネットとのセット割引もございます。",☎️,sales,low
NEW_004,REQ,契約者情報確認,"お申込みに必要な情報を確認させていただきます。契約者様のお名前、ご住所、生年月日をお教えください。",👤,sales,medium
CHANGE_001,REQ,変更内容確認,"変更手続きですね。どちらの内容を変更されたいでしょうか？",🔄,support,low
CHANGE_002,INF,プラン変更手続き,"プラン変更承りました。変更は翌月1日からの適用となります。変更手数料は無料です。",⚙️,support,low
CHANGE_003,INF,住所変更手続き,"住所変更の手続きを承ります。移転工事が必要な場合がございます。新住所をお教えください。",🏠,support,medium
CANCEL_001,REQ,解約理由確認,"解約をご希望ですね。差し支えなければ、解約の理由をお聞かせいただけますでしょうか？",❌,retention,high
CANCEL_002,INF,解約条件説明,"解約に伴い、違約金が発生する場合がございます。また、工事費の残債がある場合は一括でのお支払いとなります。",💰,retention,high
CANCEL_003,INF,引き止めオファー,"お客様により良いサービスをご提供したく、特別プランをご案内させていただけませんでしょうか？",🎁,retention,high
TROUBLE_001,REQ,故障状況確認,"故障の件でお困りですね。現在の症状について詳しくお聞かせください。",🔧,technical,high
TROUBLE_002,INF,機器確認案内,"モデムの電源ランプの状態を確認していただけますか？緑色に点灯していれば正常です。",📟,technical,high
TROUBLE_003,INF,速度測定案内,"速度が遅い場合は、まず速度測定サイトで実際の速度を測定してみてください。",📊,technical,medium
TROUBLE_004,REQ,詳細聞き取り,"その他の症状ですね。いつ頃から発生しているか、どのような状況で起こるかを詳しく教えてください。",❓,technical,medium
ID_ERROR_001,ERR,本人確認エラー,"申し訳ございませんが、お客様番号が確認できませんでした。契約者様のお名前と生年月日で確認させていただけますでしょうか？",⚠️,error,high
ESC_001,ESC,上位者エスカレーション,"申し訳ございません。より詳しい者におつなぎいたします。少々お待ちください。",🔄,escalation,high
ESC_002,ESC,技術者派遣手配,"お客様のところに技術者を派遣させていただきます。都合の良い日時をお聞かせください。",🚗,escalation,high
HOLD_001,HOLD,保留案内,"確認いたしますので、少々お待ちください。お待たせして申し訳ございません。",⏸️,process,medium
CB_001,CB,コールバック提案,"調査にお時間をいただきます。後ほどこちらからお電話させていただいてもよろしいでしょうか？",📞,process,low
CL_001,CL,通常クロージング,"ご不明な点は解決いたしましたでしょうか？他にご質問はございませんか？",✓,basic,low
CL_002,CL,満足度確認,"本日のサポートはいかがでしたでしょうか？ご満足いただけましたでしょうか？",😊,basic,low
CL_003,CL,終話挨拶,"ありがとうございました。今後ともよろしくお願いいたします。失礼いたします。",👋,basic,low
OTHER_001,QA,その他問い合わせ,"その他のお問い合わせですね。どのような内容でしょうか？",❓,support,low
FAQ_001,QA,料金確認,"ご利用料金についてですね。詳細は請求書またはWEBサイトでご確認いただけます。",💴,support,low
FAQ_002,QA,工事日程確認,"工事日程については、工事予定日の前日に改めてご連絡させていただきます。",🏗️,support,medium

script_id,branch_type,condition_text,target_script_id,option_label,option_icon,sort_order
START_001,MULTIPLE_CHOICE,用件選択,NEW_001,新規申込,📝,1
START_001,MULTIPLE_CHOICE,用件選択,CHANGE_001,変更手続き,🔄,2
START_001,MULTIPLE_CHOICE,用件選択,CANCEL_001,解約手続き,❌,3
START_001,MULTIPLE_CHOICE,用件選択,TROUBLE_001,故障・不具合,🔧,4
START_001,MULTIPLE_CHOICE,用件選択,OTHER_001,その他,❓,5
ID_001,YES_NO,本人確認完了,REQ_001,はい,✓,1
ID_001,YES_NO,本人確認失敗,ID_ERROR_001,いいえ,✗,2
NEW_001,MULTIPLE_CHOICE,サービス選択,NEW_002,インターネット,🌐,1
NEW_001,MULTIPLE_CHOICE,サービス選択,NEW_003,固定電話,☎️,2
NEW_001,MULTIPLE_CHOICE,サービス選択,NEW_002,セット契約,📦,3
NEW_002,MULTIPLE_CHOICE,プラン選択,NEW_004,ベーシック,🥉,1
NEW_002,MULTIPLE_CHOICE,プラン選択,NEW_004,スタンダード,🥈,2
NEW_002,MULTIPLE_CHOICE,プラン選択,NEW_004,プレミアム,🥇,3
CHANGE_001,MULTIPLE_CHOICE,変更内容選択,CHANGE_002,プラン変更,⚙️,1
CHANGE_001,MULTIPLE_CHOICE,変更内容選択,CHANGE_003,住所変更,🏠,2
CHANGE_001,MULTIPLE_CHOICE,変更内容選択,OTHER_001,その他変更,🔄,3
CANCEL_001,MULTIPLE_CHOICE,解約理由,CANCEL_002,料金が高い,💰,1
CANCEL_001,MULTIPLE_CHOICE,解約理由,CANCEL_002,引越し,🏠,2
CANCEL_001,MULTIPLE_CHOICE,解約理由,CANCEL_002,他社に変更,🔄,3
CANCEL_001,MULTIPLE_CHOICE,解約理由,CANCEL_003,速度不満,📊,4
TROUBLE_001,MULTIPLE_CHOICE,症状選択,TROUBLE_002,接続できない,❌,1
TROUBLE_001,MULTIPLE_CHOICE,症状選択,TROUBLE_003,速度が遅い,🐌,2
TROUBLE_001,MULTIPLE_CHOICE,症状選択,TROUBLE_002,頻繁に切れる,⚡,3
TROUBLE_001,MULTIPLE_CHOICE,症状選択,TROUBLE_004,その他,❓,4
TROUBLE_002,YES_NO,機器状態確認,CL_001,正常に復旧,✓,1
TROUBLE_002,YES_NO,機器状態確認,ESC_002,復旧しない,✗,2
ID_ERROR_001,YES_NO,代替確認,REQ_001,確認できた,✓,1
ID_ERROR_001,YES_NO,代替確認,ESC_001,確認できない,✗,2
CANCEL_002,YES_NO,解約意思確認,CL_001,解約する,✓,1
CANCEL_002,YES_NO,解約意思確認,CANCEL_003,検討する,🤔,2
CANCEL_003,YES_NO,オファー受諾,CL_001,継続する,✓,1
CANCEL_003,YES_NO,オファー受諾,CL_001,やはり解約,✗,2
CB_001,YES_NO,コールバック希望,CL_003,はい,✓,1
CB_001,YES_NO,コールバック希望,HOLD_001,いいえ,✗,2
CL_001,YES_NO,他質問確認,CL_002,ない,✓,1
CL_001,YES_NO,他質問確認,OTHER_001,ある,❓,2
CL_002,RATING,満足度評価,CL_003,満足,😊,1
CL_002,RATING,満足度評価,CL_003,普通,😐,2
CL_002,RATING,満足度評価,ESC_001,不満,😞,3


