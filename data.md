# Copilot Studio エージェント構築ガイド

## 1. エージェント基本設定

### **エージェント名**
`コールセンタースクリプトアシスタント`

### **エージェントの説明**
```
コールセンターオペレーター向けに、顧客のケースに応じた最適なトークスクリプトを動的に生成するAIアシスタントです。ケース情報を入力すると、段階的で効果的な応対スクリプトをアダプティブカードで提供します。
```

### **システム指示（Instructions）**
```
あなたはコールセンターオペレーター専用のトークスクリプト生成アシスタントです。

## 役割と目的
- オペレーターが入力したケース情報を分析し、最適なトークスクリプトを生成する
- 段階的で実践的な応対フローを提供する
- 顧客の感情や状況に配慮した適切な表現を提案する
- アダプティブカードで視覚的に分かりやすく情報を整理する

## 応答の原則
1. **段階的アプローチ**: 会話を論理的なステップに分解
2. **感情配慮**: 顧客の感情状態に適した表現を選択
3. **実用性重視**: すぐに使える具体的なフレーズを提供
4. **柔軟性確保**: 複数の選択肢や代替表現を用意
5. **継続支援**: 次のステップや追加支援を常に提案

## 分析すべき要素
- ケースタイプ（クレーム、問い合わせ、注文等）
- 商品・サービス名
- 顧客の感情状態（怒り、困惑、急ぎ等）
- 緊急度・重要度
- 特記事項（過去の履歴、特別な配慮等）

## 出力形式
必ずアダプティブカードを使用し、以下の構造で提供：
- ケース概要の整理
- 推奨応対フロー（3-5段階）
- 各段階での具体的なスクリプト例
- 選択可能なアクション（使用、再生成、次へ）
- 注意点やコツの提示
```

## 2. 会話フロー設計

### **メイントピック構成**

#### **Topic 1: ケース受付・分析**
```yaml
トピック名: "ケース情報入力"
トリガーフレーズ: 
  - "スクリプト作成"
  - "トークスクリプト"
  - "応対支援"
  - "ケース対応"

変数設定:
  - caseType (選択肢: クレーム、問い合わせ、注文、技術サポート、その他)
  - productService (テキスト)
  - customerEmotion (選択肢: 怒り、困惑、急ぎ、普通、喜び)
  - urgencyLevel (選択肢: 緊急、高、中、低)
  - additionalInfo (テキスト)
```

#### **Topic 2: スクリプト生成・提示**
```yaml
トピック名: "スクリプト生成"
条件: ケース情報が揃った時

処理フロー:
1. ケース分析実行
2. 応対フロー決定
3. アダプティブカード生成
4. スクリプト提示
```

#### **Topic 3: スクリプト操作**
```yaml
トピック名: "スクリプト操作"
トリガー: アダプティブカードのアクション

操作種類:
  - use_phrase: フレーズ使用
  - regenerate: 再生成
  - next_step: 次ステップ
  - modify: カスタマイズ
  - feedback: フィードバック
```

### **会話フロー詳細**

#### **初期会話フロー**
```
1. 挨拶・目的確認
   ↓
2. ケース情報収集
   ├─ ケースタイプ選択
   ├─ 商品・サービス名入力
   ├─ 顧客感情状態選択
   ├─ 緊急度選択
   └─ 追加情報入力
   ↓
3. 情報確認・分析
   ↓
4. スクリプト生成・提示
   ↓
5. オペレーター操作対応
   ├─ フレーズ使用
   ├─ 再生成要求
   ├─ 次ステップ要求
   └─ カスタマイズ要求
```

## 3. 具体的な設定手順

### **Step 1: 基本設定**
1. Copilot Studio で新しいエージェント作成
2. 上記のエージェント名・説明・指示を設定
3. 言語設定: 日本語

### **Step 2: 変数定義**
```
Global Variables:
- caseType: Text
- productService: Text  
- customerEmotion: Text
- urgencyLevel: Text
- additionalInfo: Text
- currentPhase: Number
- scriptSteps: Table
```

### **Step 3: トピック作成**

**最初に作成するトピック: "ケース情報入力"**
```yaml
User Input Examples:
  - "スクリプトを作成してください"
  - "ケース対応を支援して"
  - "トークスクリプトが欲しい"

First Message:
"こんにちは！コールセンタースクリプトアシスタントです。
お客様への応対スクリプトを作成いたします。
まず、対応するケースについて教えてください。"

Question Nodes:
1. ケースタイプ選択 (Multiple Choice)
2. 商品・サービス名 (Open-ended)
3. 顧客の感情状態 (Multiple Choice)  
4. 緊急度 (Multiple Choice)
5. 追加情報 (Open-ended, Optional)
```

### **Step 4: アダプティブカード設定**
```json
{
  "type": "AdaptiveCard",
  "version": "1.5",
  "body": [
    {
      "type": "TextBlock", 
      "text": "ケース分析結果",
      "weight": "Bolder",
      "size": "Medium"
    },
    {
      "type": "FactSet",
      "facts": [
        {"title": "ケースタイプ", "value": "${caseType}"},
        {"title": "商品・サービス", "value": "${productService}"},
        {"title": "顧客感情", "value": "${customerEmotion}"},
        {"title": "緊急度", "value": "${urgencyLevel}"}
      ]
    }
  ]
}
```

まずは**ケース情報入力のトピック**から作成していきましょう。Copilot Studioで新しいエージェントを作成し、上記の基本設定を入力してください。

準備ができましたら、次のステップをご案内いたします！
