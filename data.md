# Power Platform FAQ管理システム アーキテクチャ設計書
*Microsoft 365統合型・コスト最適化版*

## 1. システム全体構成

### 1.1 レイヤー構成の概要

本システムは、**4層アーキテクチャ**を採用し、Microsoft 365との深い統合により、コスト効率的でシンプルな構成を実現しています。

| レイヤー | 責務 | 主要コンポーネント |
|---------|------|-------------------|
| **ユーザー層** | ユーザーインターフェース、ユーザー体験 | 社内ユーザー（4つの権限レベル） |
| **認証・セキュリティ層** | 認証、認可、セキュリティ制御 | Azure AD, MFA, 条件付きアクセス |
| **プレゼンテーション層** | UI/UX、画面表示、レポート表示 | Power Apps, Power BI, Copilot Studio |
| **ビジネスロジック層** | 業務処理、ワークフロー、M365連携 | Power Automate |
| **データ層** | データ管理、永続化、データモデル | Dataverse + SharePoint |

### 1.2 主要設計原則

#### 1.2.1 Microsoft 365ファースト
- **既存ライセンス活用**: 追加ライセンスコストを最小化
- **ネイティブ統合**: SharePoint、Teams、Outlookとのシームレス連携
- **シンプル構成**: Power Pagesを除外してライセンス管理を簡素化

#### 1.2.2 コスト最適化
- **必要最小限の構成**: 外部システム連携を排除
- **段階的拡張**: 基本機能から開始し、必要に応じて機能追加
- **運用効率**: 既存IT管理プロセスとの統合

#### 1.2.3 セキュリティ・ガバナンス
- **Azure AD統合**: 既存のIDガバナンスを活用
- **データ保護**: Microsoft 365の標準セキュリティ機能を活用
- **コンプライアンス**: 既存のM365コンプライアンス設定を継承

## 2. コンポーネント詳細設計

### 2.1 プレゼンテーション層

#### 2.1.1 Power Apps モデル駆動アプリ
```
目的: FAQ管理システムのメイン管理画面
対象ユーザー: システム管理者、コンテンツ管理者、編集者

主要機能:
├── FAQ管理
│   ├── FAQ作成・編集（リッチテキスト対応）
│   ├── カテゴリ管理（階層構造）
│   ├── 承認ワークフロー
│   ├── 公開設定・スケジューリング
│   └── 一括インポート・エクスポート
├── ユーザー管理
│   ├── 権限管理（4段階）
│   ├── 承認者設定
│   └── アクセス制御
└── システム管理
    ├── カテゴリ設定
    ├── 通知設定
    └── 利用状況分析
```

#### 2.1.2 Power Apps キャンバスアプリ
```
目的: エンドユーザー向けFAQ検索・閲覧システム
対象ユーザー: 全社員（認証済み）

主要機能:
├── 検索機能
│   ├── キーワード検索（全文検索）
│   ├── カテゴリフィルタ
│   ├── タグ検索
│   ├── 関連FAQ自動表示
│   └── 検索履歴・お気に入り
├── 表示・操作
│   ├── FAQ詳細表示
│   ├── 添付ファイル表示・ダウンロード
│   ├── 評価・フィードバック
│   ├── Teams共有
│   └── 印刷・PDF出力
└── AI支援
    ├── Copilot Studio連携
    ├── 自然言語検索
    └── 関連コンテンツ提案
```

#### 2.1.3 外部公開FAQの代替案
```
Power Pages代替ソリューション:

オプション1: SharePoint Online公開サイト
- コスト: 既存ライセンス内
- 機能: 基本的なFAQ公開・検索
- 制限: デザインカスタマイズが限定的

オプション2: Microsoft Viva活用
- コスト: Viva Suiteライセンス（$12/user/month）
- 機能: 高度なナレッジ管理・検索
- メリット: 社内外統合ナレッジプラットフォーム

オプション3: Power Apps ゲストアクセス
- コスト: 外部ユーザーライセンス（$5/user/month）
- 機能: 限定的なFAQ閲覧
- メリット: 一貫したユーザー体験
```

### 2.2 ビジネスロジック層

#### 2.2.1 Power Automate フロー設計

**FAQ承認ワークフローフロー**
```yaml
フロー名: FAQ承認プロセス
トリガー: FAQ作成・更新時
処理手順:
  1. 作成者・更新者情報の取得
  2. カテゴリ・部署ベースでの承認者決定
  3. Teams・Outlook経由での承認依頼通知
  4. 承認者による承認・却下・修正依頼
  5. 結果通知（Teams・メール）
  6. 承認済みFAQの自動公開
  7. SharePoint検索インデックス更新
```

**更新通知自動化フロー**
```yaml
フロー名: FAQ更新・通知管理
トリガー: スケジュール実行（日次/週次）
処理手順:
  1. 新規・更新FAQの抽出
  2. カテゴリ別・部署別グループ化
  3. 関係者リスト生成（Azure AD情報活用）
  4. Teams通知・メール配信
  5. SharePointニュースフィード投稿
  6. Vivaトピックス更新（オプション）
```

**SharePoint統合フロー**
```yaml
フロー名: ナレッジ統合処理
トリガー: FAQ公開時・更新時
処理手順:
  1. FAQ内容のSharePointライブラリ同期
  2. 添付ファイルの自動保存・整理
  3. メタデータ付与（カテゴリ、タグ、作成者）
  4. SharePoint検索設定更新
  5. Microsoft Search統合
```

### 2.3 データ層設計

#### 2.3.1 Dataverse + SharePoint ハイブリッド構造

**Dataverse（構造化データ）**
```sql
-- FAQマスターテーブル
テーブル名: cr_faq
主要カラム:
├── cr_faqid (GUID) - 主キー
├── cr_title (Text, 255) - FAQタイトル
├── cr_summary (Text, 500) - 概要・要約
├── cr_category (Lookup) - カテゴリ参照
├── cr_status (Choice) - 状態管理
├── cr_priority (Choice) - 優先度
├── cr_tags (Text) - タグ（検索用）
├── cr_viewcount (Number) - 閲覧数
├── cr_rating (Decimal) - 評価スコア
├── cr_sharepointurl (Text) - SharePoint詳細ページURL
└── 標準フィールド（作成者、作成日時、更新者、更新日時）

-- カテゴリテーブル  
テーブル名: cr_category
主要カラム:
├── cr_categoryid (GUID) - 主キー
├── cr_name (Text, 100) - カテゴリ名
├── cr_parentcategory (Lookup) - 親カテゴリ（階層構造）
├── cr_description (Memo) - 説明
├── cr_icon (Text) - アイコンURL
├── cr_displayorder (Number) - 表示順序
└── cr_isactive (Boolean) - 有効フラグ
```

**SharePoint Online（非構造化データ）**
```yaml
ライブラリ構成:
├── FAQ詳細コンテンツライブラリ
│   ├── FAQ本文（HTML形式）
│   ├── 添付ファイル（画像、PDF、動画等）
│   ├── 関連ドキュメント
│   └── 履歴バージョン管理
├── カテゴリ別フォルダ構造
│   ├── 自動フォルダ作成（Power Automate）
│   ├── メタデータ自動付与
│   └── 検索最適化設定
└── 検索・発見性
    ├── Microsoft Search統合
    ├── Vivaトピックス連携
    └── 関連コンテンツ自動提案
```

#### 2.3.2 統合セキュリティモデル

**データアクセス制御**
```yaml
Dataverse セキュリティロール:
├── システム管理者
│   └── 全テーブル：作成・読み取り・更新・削除・共有・割り当て
├── コンテンツ管理者  
│   ├── FAQ：作成・読み取り・更新・削除・共有
│   ├── カテゴリ：読み取り・更新・共有
│   └── 承認権限：全FAQ承認可能
├── 編集者
│   ├── FAQ：作成・読み取り・更新（自分作成分のみ削除）
│   ├── カテゴリ：読み取りのみ
│   └── 承認権限：なし
└── 閲覧者
    ├── FAQ：読み取りのみ（公開済みのみ）
    └── カテゴリ：読み取りのみ

SharePoint アクセス権限:
├── 同期されたDataverseセキュリティ
├── 部署別アクセス制御（Azure ADグループ活用）
└── 機密情報の列レベルセキュリティ
```

## 3. Microsoft 365統合設計

### 3.1 深い統合による機能拡張

#### 3.1.1 SharePoint Online統合
```yaml
統合機能:
├── ナレッジハブ化
│   ├── FAQ + 既存ドキュメントの統合検索
│   ├── Microsoft Search活用による横断検索
│   ├── 自動分類・タグ付け（AIアシスト）
│   └── 関連コンテンツ自動提案
├── ファイル管理
│   ├── FAQ添付ファイルの自動整理
│   ├── バージョン管理・履歴追跡
│   ├── 共同編集機能
│   └── モバイルアクセス対応
└── 検索・発見
    ├── SharePoint検索Webパーツ活用
    ├── FAQ専用検索ページ作成
    └── イントラネットサイト統合
```

#### 3.1.2 Microsoft Teams統合
```yaml
統合機能:
├── 通知・コラボレーション
│   ├── FAQ更新通知のチーム自動投稿
│   ├── 承認依頼のアダプティブカード
│   ├── Teams会議でのFAQ共有
│   └── FAQ作成・編集の共同作業
├── 検索・利用
│   ├── TeamsチャットからのFAQ検索
│   ├── @メンション経由でのFAQ案内
│   ├── Teams Appとしての統合
│   └── チャネル別FAQ自動配信
└── ナレッジ共有
    ├── FAQ化候補の自動抽出（Teams会話分析）
    ├── よくある質問の自動検出
    └── エキスパート識別・案内
```

#### 3.1.3 Microsoft Viva統合（オプション）
```yaml
統合機能:
├── Viva Connections
│   ├── FAQ検索ダッシュボード
│   ├── 人気FAQカード表示
│   └── 個人化されたFAQ推奨
├── Viva Topics
│   ├── FAQ内容の自動トピック化
│   ├── エキスパート自動識別
│   └── 関連ナレッジの自動発見
└── Viva Learning
    ├── FAQベースの学習コンテンツ化
    ├── オンボーディングFAQ自動配信
    └── 部署別必須FAQ推奨
```

## 4. コスト最適化分析

### 4.1 ライセンス構成（修正版）

#### 4.1.1 必要ライセンス
```yaml
基本構成:
├── Microsoft 365 E3/E5（既存）
│   ├── SharePoint Online
│   ├── Teams
│   ├── Outlook
│   └── Azure AD P1
├── Power Platform基本ライセンス
│   ├── Power Apps（1ユーザー：$20/月）
│   ├── Power Automate（1ユーザー：$15/月）
│   └── Power BI Pro（1ユーザー：$10/月）
└── Dataverse容量
    ├── 基本容量：10GB（追加：$40/GB/月）
    └── API呼び出し制限：20,000回/日

オプション:
├── Microsoft Viva Suite: $12/user/月
│   └── 高度なナレッジ管理・検索機能
└── Power BI Premium: $20/user/月
    └── 高度な分析・レポート機能
```

#### 4.1.2 コスト比較（100ユーザー規模）
```yaml
OKBizシステム（3年間）:
├── 初期費用：130万円
├── 月額費用：10万円 × 36ヶ月 = 360万円
└── 総額：490万円

Power Platform実装（3年間・修正版）:
├── 初期開発：200-300万円
├── ライセンス費用：
│   ├── 管理者（10名）：45 × 10 × 36 = 162万円
│   ├── 一般利用者（90名）：Microsoft 365内で対応
│   └── Dataverse追加容量：40 × 5GB × 36 = 72万円
└── 総額：434-534万円

コスト削減効果:
└── 約56-90万円のコスト削減（Power Pages除外効果）
```

## 5. 実装可能性評価

### 5.1 技術的実現性

#### 5.1.1 OKBiz機能との対応表
| OKBiz機能 | Power Platform実装 | 実現度 |
|-----------|-------------------|--------|
| FAQ管理 | Dataverse + Power Apps | ✅ 100% |
| 検索機能 | SharePoint検索 + Dataverse | ✅ 95% |
| カテゴリ管理 | 階層テーブル構造 | ✅ 100% |
| 承認ワークフロー | Power Automate | ✅ 100% |
| 権限管理 | Azure AD + セキュリティロール | ✅ 100% |
| 分析・レポート | Power BI | ✅ 90% |
| モバイル対応 | Power Apps標準機能 | ✅ 100% |
| 外部公開 | SharePoint公開 | ⚠️ 70% |
| チャットボット | Copilot Studio | ✅ 90% |
| API連携 | Power Platform API | ✅ 95% |

#### 5.1.2 技術的制約・考慮事項
```yaml
制約事項:
├── 外部公開機能
│   ├── Power Pages除外による機能制限
│   ├── SharePoint公開サイトでの代替（基本機能のみ）
│   └── カスタマイズ性の制限
├── 検索機能
│   ├── OKBizの日本語特化検索エンジンより精度が劣る可能性
│   ├── SharePoint検索の調整・最適化が必要
│   └── 同義語・表記ゆれ対応の追加設定が必要
└── パフォーマンス
    ├── 大量データでの検索性能要検証
    ├── 同時接続数の上限確認が必要
    └── Dataverse容量制限の監視が必要

推奨対策:
├── フェーズ1: 社内FAQ（SharePoint + Power Apps）
├── フェーズ2: 外部公開要件の詳細検討
└── フェーズ3: 必要に応じてPower Pages追加検討
```

### 5.2 投資対効果

#### 5.2.1 定量的効果
```yaml
コスト削減:
├── FAQ管理工数：40%削減（年間480時間削減）
├── 問い合わせ対応：30%削減（年間720時間削減）
├── システム保守費：20%削減（年間60万円削減）
└── ライセンス費：Power Pages除外で年間150万円削減

生産性向上:
├── FAQ検索時間：50%短縮
├── 新人研修効率：30%向上
├── 部署間情報共有：40%改善
└── リモートワーク支援強化
```

#### 5.2.2 定性的効果
```yaml
組織的メリット:
├── Microsoft 365との統合による一貫した利用体験
├── 既存ITガバナンス・セキュリティポリシーとの整合
├── 段階的拡張による低リスク導入
└── 社内ITスキル向上（Power Platform習得）

戦略的価値:
├── デジタルワークプレース基盤の強化
├── ナレッジマネジメント文化の醸成
├── AI・自動化技術の組織内展開
└── 将来的なDX推進基盤の確立
```

この設計により、Power Pagesを除外し外部システム連携を排除することで、**初期投資200-300万円、3年総額434-534万円**で、OKBizの主要機能を90%以上カバーする実用的なシステムが構築可能です。
