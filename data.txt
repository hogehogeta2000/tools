# GHGãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ç”¨ã‚¹ã‚¿ãƒ¼ã‚¹ã‚­ãƒ¼ãƒï¼†ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ

## ğŸ“Š ã‚¹ã‚¿ãƒ¼ã‚¹ã‚­ãƒ¼ãƒè¨­è¨ˆ

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   æ™‚é–“ãƒ‡ã‚£ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³  â”‚
                    â”‚   (dim_time)     â”‚
                    â”‚                 â”‚
                    â”‚ time_id (PK)    â”‚
                    â”‚ year           â”‚
                    â”‚ month          â”‚
                    â”‚ quarter        â”‚
                    â”‚ fiscal_year    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  æ‹ ç‚¹ãƒ‡ã‚£ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³  â”‚      â”‚      â”‚ ã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒ‡ã‚£ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³â”‚
    â”‚  (dim_location)  â”‚      â”‚      â”‚ (dim_energy)    â”‚
    â”‚                 â”‚      â”‚      â”‚                 â”‚
    â”‚ location_id (PK)â”‚      â”‚      â”‚ energy_id (PK)  â”‚
    â”‚ location_name   â”‚      â”‚      â”‚ energy_type     â”‚
    â”‚ location_type   â”‚      â”‚      â”‚ energy_unit     â”‚
    â”‚ address         â”‚      â”‚      â”‚ energy_category â”‚
    â”‚ floor_area      â”‚      â”‚      â”‚ emission_factor â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚               â”‚               â”‚
             â”‚               â”‚               â”‚
             â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
             â””â”€â”€â”€â”€â”‚     äº‹å®Ÿãƒ†ãƒ¼ãƒ–ãƒ«        â”‚â”‚
                  â”‚   (fact_ghg_emissions) â”‚â”‚
                  â”‚                        â”‚â”‚
                  â”‚ time_id (FK)           â”‚â”‚
                  â”‚ location_id (FK)       â”‚â”˜
                  â”‚ energy_id (FK)         â”‚
                  â”‚ scope_id (FK)          â”‚
                  â”‚ usage_amount           â”‚
                  â”‚ co2_emissions_t        â”‚
                  â”‚ benchmark_value        â”‚
                  â”‚ target_value           â”‚
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Scopeãƒ‡ã‚£ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³â”‚
                    â”‚ (dim_scope)     â”‚
                    â”‚                 â”‚
                    â”‚ scope_id (PK)   â”‚
                    â”‚ scope_name      â”‚
                    â”‚ scope_category  â”‚
                    â”‚ description     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“‹ ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆ

### 1. æ™‚é–“ãƒ‡ã‚£ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³ (dim_time.csv)

```csv
time_id,year,month,quarter,fiscal_year,year_month
202401,2024,1,Q4,2023,2024-01
202402,2024,2,Q4,2023,2024-02
202403,2024,3,Q4,2023,2024-03
202404,2024,4,Q1,2024,2024-04
202405,2024,5,Q1,2024,2024-05
202406,2024,6,Q1,2024,2024-06
202407,2024,7,Q2,2024,2024-07
202408,2024,8,Q2,2024,2024-08
202409,2024,9,Q2,2024,2024-09
202410,2024,10,Q3,2024,2024-10
202411,2024,11,Q3,2024,2024-11
202412,2024,12,Q3,2024,2024-12
```

### 2. æ‹ ç‚¹ãƒ‡ã‚£ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³ (dim_location.csv)

```csv
location_id,location_name,location_type,address,floor_area_m2,employee_count
LOC001,å¤§é˜ªæœ¬ç¤¾,æœ¬ç¤¾äº‹å‹™æ‰€,å¤§é˜ªåºœå¤§é˜ªå¸‚æ·€å·åŒºç”°å·2-1-11,12000,680
LOC002,çµç¶æ¹–å·¥å ´,è£½é€ å·¥å ´,æ»‹è³€çœŒç”²è³€å¸‚æ°´å£ç”ºå®‡å·1110,28000,1200
LOC003,ç¥æˆ¸å·¥å ´,è£½é€ å·¥å ´,å…µåº«çœŒç¥æˆ¸å¸‚è¥¿åŒºé«˜å¡šå°5-5-1,22000,850
LOC004,ã¤ãã°ç ”ç©¶æ‰€,ç ”ç©¶é–‹ç™º,èŒ¨åŸçœŒã¤ãã°å¸‚,8500,320
LOC005,æ±äº¬å–¶æ¥­æ‰€,å–¶æ¥­æ‰€,æ±äº¬éƒ½æ¸¯åŒº,1200,85
```

### 3. ã‚¨ãƒãƒ«ã‚®ãƒ¼ãƒ‡ã‚£ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³ (dim_energy.csv)

```csv
energy_id,energy_type,energy_unit,energy_category,emission_factor,factor_unit,data_source
ENG001,é›»åŠ›,kWh,é›»æ°—ã‚¨ãƒãƒ«ã‚®ãƒ¼,0.000453,tCO2/kWh,ç’°å¢ƒçœ2024
ENG002,éƒ½å¸‚ã‚¬ã‚¹,m3,ç‡ƒæ–™,2.23,tCO2/åƒm3,ç’°å¢ƒçœ2024
ENG003,é‡æ²¹A,L,ç‡ƒæ–™,2.71,tCO2/kL,ç’°å¢ƒçœ2024
ENG004,è»½æ²¹,L,ç‡ƒæ–™,2.58,tCO2/kL,ç’°å¢ƒçœ2024
ENG005,ã‚¬ã‚½ãƒªãƒ³,L,ç‡ƒæ–™,2.32,tCO2/kL,ç’°å¢ƒçœ2024
ENG006,SF6ã‚¬ã‚¹,kg,å·¥æ¥­ã‚¬ã‚¹,22800,tCO2/t,ç’°å¢ƒçœ2024
ENG007,çµ¶ç¸æ²¹,L,å·¥æ¥­ç”¨æ²¹,2.1,tCO2/kL,æ¨å®šå€¤
```

### 4. Scopeãƒ‡ã‚£ãƒ¡ãƒ³ã‚·ãƒ§ãƒ³ (dim_scope.csv)

```csv
scope_id,scope_name,scope_category,description
SC001,Scope1,ç›´æ¥æ’å‡º,è‡ªç¤¾ã§ã®ç‡ƒæ–™ç‡ƒç„¼ã«ã‚ˆã‚‹ç›´æ¥æ’å‡º
SC002,Scope2,é–“æ¥æ’å‡º,è³¼å…¥é›»åŠ›ãƒ»ç†±ã«ã‚ˆã‚‹é–“æ¥æ’å‡º
SC003,Scope3-Cat1,é–“æ¥æ’å‡º,è³¼å…¥ã—ãŸè£½å“ãƒ»ã‚µãƒ¼ãƒ“ã‚¹
SC004,Scope3-Cat2,é–“æ¥æ’å‡º,è³‡æœ¬è²¡
SC005,Scope3-Cat4,é–“æ¥æ’å‡º,è¼¸é€ãƒ»é…é€(ä¸Šæµ)
SC006,Scope3-Cat5,é–“æ¥æ’å‡º,äº‹æ¥­ã‹ã‚‰å‡ºã‚‹å»ƒæ£„ç‰©
SC007,Scope3-Cat6,é–“æ¥æ’å‡º,å‡ºå¼µ
SC008,Scope3-Cat7,é–“æ¥æ’å‡º,å¾“æ¥­å“¡ã®é€šå‹¤
```

### 5. äº‹å®Ÿãƒ†ãƒ¼ãƒ–ãƒ« (fact_ghg_emissions.csv)

```csv
time_id,location_id,energy_id,scope_id,usage_amount,co2_emissions_t,benchmark_value_t,target_value_t,data_quality
202401,LOC001,ENG001,SC002,45000,20.4,22.1,19.5,å®Ÿæ¸¬
202401,LOC002,ENG001,SC002,165000,74.7,79.8,71.2,å®Ÿæ¸¬
202401,LOC002,ENG002,SC001,11000,24.5,26.2,23.0,å®Ÿæ¸¬
202401,LOC002,ENG003,SC001,7500,20.3,21.8,19.1,å®Ÿæ¸¬
202401,LOC002,ENG006,SC001,0.1,2.3,2.5,2.1,å®Ÿæ¸¬
202401,LOC003,ENG001,SC002,125000,56.6,62.1,54.0,å®Ÿæ¸¬
202401,LOC003,ENG002,SC001,8200,18.3,19.8,17.1,å®Ÿæ¸¬
202401,LOC004,ENG001,SC002,25000,11.3,12.5,10.8,å®Ÿæ¸¬
202401,LOC005,ENG001,SC002,8500,3.9,4.2,3.5,å®Ÿæ¸¬
202402,LOC001,ENG001,SC002,42000,19.0,22.1,19.5,å®Ÿæ¸¬
202402,LOC002,ENG001,SC002,158000,71.6,79.8,71.2,å®Ÿæ¸¬
202402,LOC002,ENG002,SC001,10500,23.4,26.2,23.0,å®Ÿæ¸¬
202402,LOC002,ENG003,SC001,7200,19.5,21.8,19.1,å®Ÿæ¸¬
202402,LOC002,ENG006,SC001,0.09,2.1,2.5,2.1,å®Ÿæ¸¬
202402,LOC003,ENG001,SC002,119000,53.9,62.1,54.0,å®Ÿæ¸¬
202402,LOC003,ENG002,SC001,7800,17.4,19.8,17.1,å®Ÿæ¸¬
202402,LOC004,ENG001,SC002,23500,10.6,12.5,10.8,å®Ÿæ¸¬
202402,LOC005,ENG001,SC002,8100,3.7,4.2,3.5,å®Ÿæ¸¬
202403,LOC001,ENG001,SC002,43500,19.7,22.1,19.5,å®Ÿæ¸¬
202403,LOC002,ENG001,SC002,162000,73.4,79.8,71.2,å®Ÿæ¸¬
202403,LOC002,ENG002,SC001,10800,24.1,26.2,23.0,å®Ÿæ¸¬
202403,LOC002,ENG003,SC001,7400,20.1,21.8,19.1,å®Ÿæ¸¬
202403,LOC002,ENG006,SC001,0.095,2.2,2.5,2.1,å®Ÿæ¸¬
202403,LOC003,ENG001,SC002,122000,55.3,62.1,54.0,å®Ÿæ¸¬
202403,LOC003,ENG002,SC001,8000,17.8,19.8,17.1,å®Ÿæ¸¬
202403,LOC004,ENG001,SC002,24200,11.0,12.5,10.8,å®Ÿæ¸¬
202403,LOC005,ENG001,SC002,8300,3.8,4.2,3.5,å®Ÿæ¸¬
```

### 6. Scope3æ¨å®šãƒ‡ãƒ¼ã‚¿ (fact_scope3_emissions.csv)

```csv
time_id,location_id,scope_id,category_name,co2_emissions_t,calculation_method,data_source
202401,LOC002,SC003,è³¼å…¥è£½å“ãƒ»ã‚µãƒ¼ãƒ“ã‚¹,420.5,èª¿é”é‡‘é¡Ã—æ’å‡ºåŸå˜ä½,èª¿é”ã‚·ã‚¹ãƒ†ãƒ 
202401,LOC002,SC004,è³‡æœ¬è²¡,85.2,å›ºå®šè³‡ç”£å–å¾—é¡Ã—æ’å‡ºåŸå˜ä½,ä¼šè¨ˆã‚·ã‚¹ãƒ†ãƒ 
202401,LOC002,SC005,è¼¸é€ãƒ»é…é€(ä¸Šæµ),58.9,ç‰©æµè²»Ã—æ’å‡ºåŸå˜ä½,ç‰©æµå®Ÿç¸¾
202401,LOC002,SC006,å»ƒæ£„ç‰©,32.1,å»ƒæ£„ç‰©é‡Ã—å‡¦ç†åˆ¥æ’å‡ºåŸå˜ä½,å»ƒæ£„ç‰©å®Ÿç¸¾
202401,LOC002,SC007,å‡ºå¼µ,12.3,äº¤é€šè²»Ã—æ’å‡ºåŸå˜ä½,çµŒè²»ã‚·ã‚¹ãƒ†ãƒ 
202401,LOC002,SC008,é€šå‹¤,35.8,å¾“æ¥­å“¡æ•°Ã—é€šå‹¤è·é›¢Ã—æ’å‡ºåŸå˜ä½,é€šå‹¤å®Ÿæ…‹èª¿æŸ»
202402,LOC002,SC003,è³¼å…¥è£½å“ãƒ»ã‚µãƒ¼ãƒ“ã‚¹,398.2,èª¿é”é‡‘é¡Ã—æ’å‡ºåŸå˜ä½,èª¿é”ã‚·ã‚¹ãƒ†ãƒ 
202402,LOC002,SC004,è³‡æœ¬è²¡,92.1,å›ºå®šè³‡ç”£å–å¾—é¡Ã—æ’å‡ºåŸå˜ä½,ä¼šè¨ˆã‚·ã‚¹ãƒ†ãƒ 
202402,LOC002,SC005,è¼¸é€ãƒ»é…é€(ä¸Šæµ),55.3,ç‰©æµè²»Ã—æ’å‡ºåŸå˜ä½,ç‰©æµå®Ÿç¸¾
202402,LOC002,SC006,å»ƒæ£„ç‰©,29.8,å»ƒæ£„ç‰©é‡Ã—å‡¦ç†åˆ¥æ’å‡ºåŸå˜ä½,å»ƒæ£„ç‰©å®Ÿç¸¾
202402,LOC002,SC007,å‡ºå¼µ,8.9,äº¤é€šè²»Ã—æ’å‡ºåŸå˜ä½,çµŒè²»ã‚·ã‚¹ãƒ†ãƒ 
202402,LOC002,SC008,é€šå‹¤,35.8,å¾“æ¥­å“¡æ•°Ã—é€šå‹¤è·é›¢Ã—æ’å‡ºåŸå˜ä½,é€šå‹¤å®Ÿæ…‹èª¿æŸ»
```

### 7. å‰Šæ¸›ç›®æ¨™ç®¡ç†ãƒ†ãƒ¼ãƒ–ãƒ« (target_management.csv)

```csv
target_id,location_id,target_year,target_month,baseline_year,baseline_emissions_t,target_emissions_t,reduction_rate,status
TGT001,LOC002,2024,12,2019,1850.5,1480.4,20.0,é€²è¡Œä¸­
TGT002,LOC003,2024,12,2019,1420.8,1136.6,20.0,é€²è¡Œä¸­
TGT003,LOC001,2024,12,2019,285.2,228.2,20.0,é€²è¡Œä¸­
TGT004,LOC004,2024,12,2019,158.5,126.8,20.0,é€²è¡Œä¸­
TGT005,LOC005,2024,12,2019,52.3,41.8,20.0,é€²è¡Œä¸­
```

## ğŸ”§ ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆåˆ©ç”¨æ–¹æ³•

### SQLã‚¯ã‚¨ãƒªä¾‹

```sql
-- æœˆæ¬¡æ’å‡ºé‡é›†è¨ˆ
SELECT 
    t.year_month,
    l.location_name,
    s.scope_name,
    SUM(f.co2_emissions_t) as total_emissions
FROM fact_ghg_emissions f
JOIN dim_time t ON f.time_id = t.time_id
JOIN dim_location l ON f.location_id = l.location_id
JOIN dim_scope s ON f.scope_id = s.scope_id
WHERE t.year = 2024
GROUP BY t.year_month, l.location_name, s.scope_name
ORDER BY t.year_month, l.location_name;

-- ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯æ¯”è¼ƒ
SELECT 
    l.location_name,
    e.energy_type,
    SUM(f.co2_emissions_t) as actual_emissions,
    SUM(f.benchmark_value_t) as benchmark_emissions,
    ROUND((SUM(f.co2_emissions_t) / SUM(f.benchmark_value_t) - 1) * 100, 1) as variance_pct
FROM fact_ghg_emissions f
JOIN dim_location l ON f.location_id = l.location_id
JOIN dim_energy e ON f.energy_id = e.energy_id
WHERE f.time_id BETWEEN 202401 AND 202403
GROUP BY l.location_name, e.energy_type;
```

### Pythonã§ã®èª­ã¿è¾¼ã¿ä¾‹

```python
import pandas as pd

# ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆèª­ã¿è¾¼ã¿
dim_time = pd.read_csv('dim_time.csv')
dim_location = pd.read_csv('dim_location.csv')
dim_energy = pd.read_csv('dim_energy.csv')
dim_scope = pd.read_csv('dim_scope.csv')
fact_ghg = pd.read_csv('fact_ghg_emissions.csv')

# çµåˆã—ã¦ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ç”¨ãƒ‡ãƒ¼ã‚¿ä½œæˆ
dashboard_data = fact_ghg.merge(dim_time, on='time_id') \
                        .merge(dim_location, on='location_id') \
                        .merge(dim_energy, on='energy_id') \
                        .merge(dim_scope, on='scope_id')
```

## âœ… ãƒ‡ãƒ¼ã‚¿å“è³ªãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆ

1. **ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§**: å¤–éƒ¨ã‚­ãƒ¼åˆ¶ç´„ã®ç¢ºèª
2. **æ¬ æå€¤**: å¿…é ˆé …ç›®ã®æ¬ æãƒã‚§ãƒƒã‚¯
3. **ç¯„å›²ãƒã‚§ãƒƒã‚¯**: CO2æ’å‡ºé‡ã®å¦¥å½“æ€§ç¢ºèª
4. **æ™‚ç³»åˆ—ä¸€è²«æ€§**: æœˆæ¬¡ãƒ‡ãƒ¼ã‚¿ã®é€£ç¶šæ€§
5. **ãƒ™ãƒ³ãƒãƒãƒ¼ã‚¯å¦¥å½“æ€§**: æ¥­ç•Œå¹³å‡ã¨ã®ä¹–é›¢åº¦åˆã„

ã“ã®ã‚¹ã‚¿ãƒ¼ã‚¹ã‚­ãƒ¼ãƒã¨ãƒ‡ãƒ¼ã‚¿ã‚»ãƒƒãƒˆã«ã‚ˆã‚Šã€åŠ¹ç‡çš„ãªGHGãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã®æ§‹ç¯‰ãŒå¯èƒ½ã«ãªã‚Šã¾ã™ã€‚
