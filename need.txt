ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’æ´»ç”¨ã—ã¦ã€YoYï¼ˆå‰å¹´åŒæœŸæ¯”ï¼‰ã‚’å«ã‚€æ®‹é«˜åˆ†æãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚’ä½œæˆã™ã‚‹å…·ä½“çš„ãªã‚¹ãƒ†ãƒƒãƒ—ã‚’ãŠæ•™ãˆã—ã¾ã™ã€‚

## ğŸ¦ **ç¾åœ¨ãƒ‡ãƒ¼ã‚¿ã§YoYæ®‹é«˜åˆ†æå®Ÿè£…ã‚¹ãƒ†ãƒƒãƒ—**

### **Step 1: æ®‹é«˜æ¨è¨ˆãƒ­ã‚¸ãƒƒã‚¯ã®æ§‹ç¯‰**

**åŸºæœ¬çš„ãªæ®‹é«˜æ¨è¨ˆãƒ¡ã‚¸ãƒ£ãƒ¼**
```dax
// 1. ç´¯ç©å–å¼•é¡ãƒ™ãƒ¼ã‚¹ã®æ®‹é«˜æ¨è¨ˆ
Estimated Balance = 
CALCULATE(
    SUM(sales_performance[amount]),
    FILTER(
        ALL(sales_performance[transaction_date]),
        sales_performance[transaction_date] <= MAX(sales_performance[transaction_date])
    )
)

// 2. å•†å“åˆ¥æ®‹é«˜åˆ†é¡
Balance Type = 
VAR ProductCategory = 
    LOOKUPVALUE(
        products[product_category], 
        products[product_id], 
        SELECTEDVALUE(sales_performance[product_id])
    )
RETURN
SWITCH(
    ProductCategory,
    "é é‡‘", "é é‡‘æ®‹é«˜",
    "èè³‡", "èè³‡æ®‹é«˜", 
    "æŠ•è³‡ä¿¡è¨—", "é‹ç”¨è³‡ç”£",
    "ä¿é™º", "ä¿é™ºè³‡ç”£",
    "ãã®ä»–è³‡ç”£"
)

// 3. æœˆæœ«æ®‹é«˜æ¨è¨ˆ
Month End Balance = 
CALCULATE(
    [Estimated Balance],
    ENDOFMONTH(sales_performance[transaction_date])
)
```

### **Step 2: æ—¥ä»˜ãƒ†ãƒ¼ãƒ–ãƒ«ã®æ‹¡å¼µ**

**æ—¥ä»˜ãƒ†ãƒ¼ãƒ–ãƒ«ã«å¿…è¦ãªè¨ˆç®—åˆ—ã‚’è¿½åŠ **
```dax
// æ—¥ä»˜ãƒ†ãƒ¼ãƒ–ãƒ«ã«è¿½åŠ ã™ã‚‹è¨ˆç®—åˆ—
Is Month End = 
DATE(
    YEAR([Date]),
    MONTH([Date]),
    DAY(EOMONTH([Date], 0))
) = [Date]

Year Month = 
YEAR([Date]) * 100 + MONTH([Date])

Year Month Text = 
FORMAT([Date], "YYYYå¹´MMæœˆ")

Previous Year Same Month = 
DATE(YEAR([Date]) - 1, MONTH([Date]), DAY([Date]))
```

### **Step 3: YoYæ®‹é«˜åˆ†æãƒ¡ã‚¸ãƒ£ãƒ¼**

**å‰å¹´åŒæœŸæ¯”åˆ†æã®æ ¸ã¨ãªã‚‹ãƒ¡ã‚¸ãƒ£ãƒ¼**
```dax
// 4. å½“å¹´æ®‹é«˜ï¼ˆæœˆæœ«ãƒ™ãƒ¼ã‚¹ï¼‰
Current Year Balance = 
CALCULATE(
    SUM(sales_performance[amount]),
    FILTER(
        ALL(sales_performance[transaction_date]),
        sales_performance[transaction_date] <= EOMONTH(MAX(sales_performance[transaction_date]), 0)
    )
)

// 5. å‰å¹´åŒæœŸæ®‹é«˜
Previous Year Balance = 
CALCULATE(
    [Current Year Balance],
    SAMEPERIODLASTYEAR(sales_performance[transaction_date])
)

// 6. YoYæ®‹é«˜æˆé•·ç‡
Balance YoY Growth Rate = 
VAR CurrentBalance = [Current Year Balance]
VAR PreviousBalance = [Previous Year Balance]
RETURN
DIVIDE(CurrentBalance - PreviousBalance, PreviousBalance, 0) * 100

// 7. YoYæ®‹é«˜å¢—æ¸›é¡
Balance YoY Change Amount = 
[Current Year Balance] - [Previous Year Balance]

// 8. YoYæˆé•·ç‡ã‚«ãƒ†ã‚´ãƒª
YoY Growth Category = 
VAR GrowthRate = [Balance YoY Growth Rate]
RETURN
SWITCH(
    TRUE(),
    GrowthRate > 20, "é«˜æˆé•· (>20%)",
    GrowthRate > 10, "æˆé•· (10-20%)",
    GrowthRate > 0, "å¾®æˆé•· (0-10%)",
    GrowthRate > -10, "å¾®æ¸› (0~-10%)",
    "å¤§å¹…æ¸› (<-10%)"
)
```

### **Step 4: å•†å“ã‚«ãƒ†ã‚´ãƒªåˆ¥YoYåˆ†æ**

**å•†å“ã‚«ãƒ†ã‚´ãƒªã”ã¨ã®è©³ç´°åˆ†æ**
```dax
// 9. é é‡‘æ®‹é«˜YoYåˆ†æ
Deposit Balance Current = 
CALCULATE(
    [Current Year Balance],
    FILTER(
        sales_performance,
        LOOKUPVALUE(products[product_category], products[product_id], sales_performance[product_id]) = "é é‡‘"
    )
)

Deposit Balance Previous = 
CALCULATE(
    [Previous Year Balance],
    FILTER(
        sales_performance,
        LOOKUPVALUE(products[product_category], products[product_id], sales_performance[product_id]) = "é é‡‘"
    )
)

Deposit YoY Growth = 
DIVIDE([Deposit Balance Current] - [Deposit Balance Previous], [Deposit Balance Previous], 0) * 100

// 10. èè³‡æ®‹é«˜YoYåˆ†æ
Loan Balance Current = 
CALCULATE(
    [Current Year Balance],
    FILTER(
        sales_performance,
        LOOKUPVALUE(products[product_category], products[product_id], sales_performance[product_id]) = "èè³‡"
    )
)

Loan Balance Previous = 
CALCULATE(
    [Previous Year Balance],
    FILTER(
        sales_performance,
        LOOKUPVALUE(products[product_category], products[product_id], sales_performance[product_id]) = "èè³‡"
    )
)

Loan YoY Growth = 
DIVIDE([Loan Balance Current] - [Loan Balance Previous], [Loan Balance Previous], 0) * 100

// 11. æŠ•è³‡ä¿¡è¨—æ®‹é«˜YoYåˆ†æ
Investment Balance Current = 
CALCULATE(
    [Current Year Balance],
    FILTER(
        sales_performance,
        LOOKUPVALUE(products[product_category], products[product_id], sales_performance[product_id]) = "æŠ•è³‡ä¿¡è¨—"
    )
)

Investment Balance Previous = 
CALCULATE(
    [Previous Year Balance],
    FILTER(
        sales_performance,
        LOOKUPVALUE(products[product_category], products[product_id], sales_performance[product_id]) = "æŠ•è³‡ä¿¡è¨—"
    )
)

Investment YoY Growth = 
DIVIDE([Investment Balance Current] - [Investment Balance Previous], [Investment Balance Previous], 0) * 100
```

### **Step 5: æ”¯åº—ãƒ»åœ°åŸŸåˆ¥YoYåˆ†æ**

**åœ°åŸŸåˆ¥ã®æ®‹é«˜æˆé•·åˆ†æ**
```dax
// 12. æ”¯åº—åˆ¥YoYåˆ†æ
Branch Balance Current = 
CALCULATE(
    [Current Year Balance],
    FILTER(
        sales_performance,
        LOOKUPVALUE(employees[branch_id], employees[employee_id], sales_performance[employee_id]) = SELECTEDVALUE(branches[branch_id])
    )
)

Branch Balance Previous = 
CALCULATE(
    [Previous Year Balance],
    FILTER(
        sales_performance,
        LOOKUPVALUE(employees[branch_id], employees[employee_id], sales_performance[employee_id]) = SELECTEDVALUE(branches[branch_id])
    )
)

Branch YoY Growth = 
DIVIDE([Branch Balance Current] - [Branch Balance Previous], [Branch Balance Previous], 0) * 100

// 13. åœ°åŸŸåˆ¥é›†è¨ˆ
Region Balance YoY = 
VAR SelectedRegion = SELECTEDVALUE(branches[region])
RETURN
CALCULATE(
    [Balance YoY Growth Rate],
    FILTER(
        ALL(branches),
        branches[region] = SelectedRegion
    )
)
```

### **Step 6: æ™‚ç³»åˆ—ãƒˆãƒ¬ãƒ³ãƒ‰åˆ†æ**

**æœˆæ¬¡ãƒˆãƒ¬ãƒ³ãƒ‰ã¨YoYæ¯”è¼ƒ**
```dax
// 14. æœˆæ¬¡æ®‹é«˜æ¨ç§»
Monthly Balance Trend = 
CALCULATE(
    [Current Year Balance],
    DATESMTD(sales_performance[transaction_date])
)

// 15. 12ã‹æœˆç§»å‹•å¹³å‡
12M Moving Average Balance = 
CALCULATE(
    AVERAGEX(
        DATESINPERIOD(
            sales_performance[transaction_date],
            MAX(sales_performance[transaction_date]),
            -12,
            MONTH
        ),
        [Current Year Balance]
    )
)

// 16. å››åŠæœŸæˆé•·ç‡
Quarterly Growth Rate = 
VAR CurrentQuarter = [Current Year Balance]
VAR PreviousQuarter = 
    CALCULATE(
        [Current Year Balance],
        DATEADD(sales_performance[transaction_date], -1, QUARTER)
    )
RETURN
DIVIDE(CurrentQuarter - PreviousQuarter, PreviousQuarter, 0) * 100
```

### **Step 7: è¡¨ç¤ºç”¨ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãƒ¡ã‚¸ãƒ£ãƒ¼**

**ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰è¡¨ç¤ºç”¨ã®è¦‹ã‚„ã™ã„ãƒ¡ã‚¸ãƒ£ãƒ¼**
```dax
// 17. è¡¨ç¤ºç”¨ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆ
Current Balance Display = 
FORMAT([Current Year Balance], "#,##0,,.0") & "å„„å††"

YoY Growth Display = 
VAR Growth = [Balance YoY Growth Rate]
RETURN
FORMAT(Growth, "+#,##0.0%;-#,##0.0%")

YoY Change Display = 
VAR Change = [Balance YoY Change Amount]
RETURN
IF(Change > 0, "â–²", "â–¼") & FORMAT(ABS(Change), "#,##0,,.0") & "å„„å††"

Balance Trend Indicator = 
VAR Growth = [Balance YoY Growth Rate]
RETURN
SWITCH(
    TRUE(),
    Growth > 10, "ğŸŸ¢ å¥½èª¿",
    Growth > 0, "ğŸ”µ å®‰å®š",
    Growth > -5, "ğŸŸ¡ æ³¨æ„", 
    "ğŸ”´ è¦å¯¾ç­–"
)
```

### **Step 8: ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰æ§‹æˆ**

**æ¨å¥¨ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼ˆä¸Šã‹ã‚‰é †ã«ï¼‰**

**1. KPIã‚µãƒãƒªãƒ¼ã‚«ãƒ¼ãƒ‰ï¼ˆ4æšæ¨ªä¸¦ã³ï¼‰**
```
[ç·æ®‹é«˜] [YoYæˆé•·ç‡] [æˆé•·é¡] [ãƒˆãƒ¬ãƒ³ãƒ‰]
Current Balance Display | YoY Growth Display | YoY Change Display | Balance Trend Indicator
```

**2. æ®‹é«˜æ¨ç§»ã¨YoYæ¯”è¼ƒãƒãƒ£ãƒ¼ãƒˆ**
- **ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«å**: è¤‡åˆãƒãƒ£ãƒ¼ãƒˆï¼ˆæŠ˜ã‚Œç·šï¼‹æ£’ã‚°ãƒ©ãƒ•ï¼‰
- **Xè»¸**: `sales_performance[transaction_date]` (æœˆ)
- **ä¸»è»¸ï¼ˆæ£’ï¼‰**: `Current Year Balance`, `Previous Year Balance` 
- **å‰¯è»¸ï¼ˆç·šï¼‰**: `Balance YoY Growth Rate`

**3. å•†å“ã‚«ãƒ†ã‚´ãƒªåˆ¥YoYæˆé•·**
- **ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«å**: é›†åˆæ¨ªæ£’ã‚°ãƒ©ãƒ•
- **Yè»¸**: å•†å“ã‚«ãƒ†ã‚´ãƒª
- **Xè»¸**: `Deposit YoY Growth`, `Loan YoY Growth`, `Investment YoY Growth`

**4. æ”¯åº—åˆ¥YoYãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹**
- **ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«å**: ãƒãƒˆãƒªãƒƒã‚¯ã‚¹
- **è¡Œ**: `branches[region]`, `branches[branch_name]`
- **å€¤**: `Branch YoY Growth`, `Branch Balance Current`, `YoY Growth Category`

**5. å››åŠæœŸãƒˆãƒ¬ãƒ³ãƒ‰åˆ†æ**
- **ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«å**: é¢ã‚°ãƒ©ãƒ•
- **Xè»¸**: å››åŠæœŸ
- **Yè»¸**: `Quarterly Growth Rate`
- **å‡¡ä¾‹**: å•†å“ã‚«ãƒ†ã‚´ãƒª

### **Step 9: å®Ÿè£…å„ªå…ˆé †ä½**

**Phase 1ï¼ˆå³åº§ã«å®Ÿè£…å¯èƒ½ï¼‰**
1. `Current Year Balance`, `Previous Year Balance`
2. `Balance YoY Growth Rate`, `Balance YoY Change Amount`
3. åŸºæœ¬çš„ãªKPIã‚«ãƒ¼ãƒ‰

**Phase 2ï¼ˆè©³ç´°åˆ†æï¼‰**
4. å•†å“ã‚«ãƒ†ã‚´ãƒªåˆ¥YoYåˆ†æ
5. æ”¯åº—ãƒ»åœ°åŸŸåˆ¥YoYåˆ†æ

**Phase 3ï¼ˆé«˜åº¦ãªåˆ†æï¼‰**
6. ãƒˆãƒ¬ãƒ³ãƒ‰åˆ†æã¨äºˆæ¸¬
7. ç•°å¸¸å€¤æ¤œçŸ¥ã¨ã‚¢ãƒ©ãƒ¼ãƒˆ

### **Step 10: ãƒ‡ãƒ¼ã‚¿æ¤œè¨¼**

**å®Ÿè£…å‰ã®ç¢ºèªäº‹é …**
```dax
// ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ãƒã‚§ãƒƒã‚¯
Data Quality Check = 
VAR TransactionCount = DISTINCTCOUNT(sales_performance[transaction_id])
VAR DateRange = DATEDIFF(MIN(sales_performance[transaction_date]), MAX(sales_performance[transaction_date]), DAY)
VAR ProductCoverage = DISTINCTCOUNT(sales_performance[product_id])
RETURN
"å–å¼•ä»¶æ•°: " & TransactionCount & " | æœŸé–“: " & DateRange & "æ—¥ | å•†å“æ•°: " & ProductCoverage
```

å£²ä¸Šã®YoYï¼ˆå‰å¹´åŒæœŸæ¯”ï¼‰åˆ†æã«ç‰¹åŒ–ã—ãŸDAXãƒ¡ã‚¸ãƒ£ãƒ¼ã‚’ã€ç¾åœ¨ã®ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã«åŸºã¥ã„ã¦æä¾›ã„ãŸã—ã¾ã™ã€‚

## ğŸ“ˆ **Sales YoY Analysis DAX Measures**

### **Basic Sales YoY Metrics**

```dax
// 1. åŸºæœ¬å£²ä¸Šãƒ¡ã‚¸ãƒ£ãƒ¼
Total Sales = SUM(sales_performance[amount])

Total Commission = SUM(sales_performance[commission_amount])

Transaction Count = DISTINCTCOUNT(sales_performance[transaction_id])

// 2. å‰å¹´åŒæœŸå£²ä¸Š
Sales Previous Year = 
CALCULATE(
    [Total Sales],
    SAMEPERIODLASTYEAR(sales_performance[transaction_date])
)

// 3. YoYå£²ä¸Šæˆé•·ç‡
Sales YoY Growth Rate = 
VAR CurrentSales = [Total Sales]
VAR PreviousSales = [Sales Previous Year]
RETURN
DIVIDE(CurrentSales - PreviousSales, PreviousSales, 0) * 100

// 4. YoYå£²ä¸Šæˆé•·é¡
Sales YoY Growth Amount = 
[Total Sales] - [Sales Previous Year]

// 5. YoYæˆé•·ç‡ã‚«ãƒ†ã‚´ãƒª
Sales YoY Category = 
VAR GrowthRate = [Sales YoY Growth Rate]
RETURN
SWITCH(
    TRUE(),
    GrowthRate > 50, "æ€¥æˆé•· (>50%)",
    GrowthRate > 20, "é«˜æˆé•· (20-50%)",
    GrowthRate > 10, "æˆé•· (10-20%)",
    GrowthRate > 0, "å¾®æˆé•· (0-10%)",
    GrowthRate > -10, "å¾®æ¸› (0~-10%)",
    GrowthRate > -20, "æ¸›å°‘ (-10~-20%)",
    "å¤§å¹…æ¸› (<-20%)"
)
```

### **Monthly YoY Analysis**

```dax
// 6. æœˆåˆ¥YoYåˆ†æ
Sales MTD = 
CALCULATE(
    [Total Sales],
    DATESMTD(sales_performance[transaction_date])
)

Sales MTD Previous Year = 
CALCULATE(
    [Sales MTD],
    SAMEPERIODLASTYEAR(sales_performance[transaction_date])
)

Sales MTD YoY Growth = 
DIVIDE([Sales MTD] - [Sales MTD Previous Year], [Sales MTD Previous Year], 0) * 100

// 7. æœˆæœ«æ™‚ç‚¹ã®ç´¯è¨ˆYoY
Sales YTD = 
CALCULATE(
    [Total Sales],
    DATESYTD(sales_performance[transaction_date])
)

Sales YTD Previous Year = 
CALCULATE(
    [Sales YTD],
    SAMEPERIODLASTYEAR(sales_performance[transaction_date])
)

Sales YTD YoY Growth = 
DIVIDE([Sales YTD] - [Sales YTD Previous Year], [Sales YTD Previous Year], 0) * 100
```

### **Quarterly YoY Analysis**

```dax
// 8. å››åŠæœŸåˆ¥YoYåˆ†æ
Sales QTD = 
CALCULATE(
    [Total Sales],
    DATESQTD(sales_performance[transaction_date])
)

Sales QTD Previous Year = 
CALCULATE(
    [Sales QTD],
    SAMEPERIODLASTYEAR(sales_performance[transaction_date])
)

Sales QTD YoY Growth = 
DIVIDE([Sales QTD] - [Sales QTD Previous Year], [Sales QTD Previous Year], 0) * 100

// 9. å››åŠæœŸå¯¾å››åŠæœŸæ¯”è¼ƒ
Sales Previous Quarter = 
CALCULATE(
    [Total Sales],
    DATEADD(sales_performance[transaction_date], -1, QUARTER)
)

Sales QoQ Growth = 
DIVIDE([Total Sales] - [Sales Previous Quarter], [Sales Previous Quarter], 0) * 100
```

### **Product Category YoY Analysis**

```dax
// 10. å•†å“ã‚«ãƒ†ã‚´ãƒªåˆ¥YoYåˆ†æ
Deposit Sales YoY = 
VAR CurrentSales = 
    CALCULATE(
        [Total Sales],
        FILTER(
            sales_performance,
            LOOKUPVALUE(products[product_category], products[product_id], sales_performance[product_id]) = "é é‡‘"
        )
    )
VAR PreviousSales = 
    CALCULATE(
        CurrentSales,
        SAMEPERIODLASTYEAR(sales_performance[transaction_date])
    )
RETURN
DIVIDE(CurrentSales - PreviousSales, PreviousSales, 0) * 100

Loan Sales YoY = 
VAR CurrentSales = 
    CALCULATE(
        [Total Sales],
        FILTER(
            sales_performance,
            LOOKUPVALUE(products[product_category], products[product_id], sales_performance[product_id]) = "èè³‡"
        )
    )
VAR PreviousSales = 
    CALCULATE(
        CurrentSales,
        SAMEPERIODLASTYEAR(sales_performance[transaction_date])
    )
RETURN
DIVIDE(CurrentSales - PreviousSales, PreviousSales, 0) * 100

Investment Sales YoY = 
VAR CurrentSales = 
    CALCULATE(
        [Total Sales],
        FILTER(
            sales_performance,
            LOOKUPVALUE(products[product_category], products[product_id], sales_performance[product_id]) = "æŠ•è³‡ä¿¡è¨—"
        )
    )
VAR PreviousSales = 
    CALCULATE(
        CurrentSales,
        SAMEPERIODLASTYEAR(sales_performance[transaction_date])
    )
RETURN
DIVIDE(CurrentSales - PreviousSales, PreviousSales, 0) * 100

Insurance Sales YoY = 
VAR CurrentSales = 
    CALCULATE(
        [Total Sales],
        FILTER(
            sales_performance,
            LOOKUPVALUE(products[product_category], products[product_id], sales_performance[product_id]) = "ä¿é™º"
        )
    )
VAR PreviousSales = 
    CALCULATE(
        CurrentSales,
        SAMEPERIODLASTYEAR(sales_performance[transaction_date])
    )
RETURN
DIVIDE(CurrentSales - PreviousSales, PreviousSales, 0) * 100
```

### **Employee & Branch YoY Analysis**

```dax
// 14. å¾“æ¥­å“¡åˆ¥YoYåˆ†æ
Employee Sales YoY = 
VAR SelectedEmployee = SELECTEDVALUE(sales_performance[employee_id])
VAR CurrentSales = 
    CALCULATE(
        [Total Sales],
        sales_performance[employee_id] = SelectedEmployee
    )
VAR PreviousSales = 
    CALCULATE(
        CurrentSales,
        SAMEPERIODLASTYEAR(sales_performance[transaction_date])
    )
RETURN
DIVIDE(CurrentSales - PreviousSales, PreviousSales, 0) * 100

// 15. æ”¯åº—åˆ¥YoYåˆ†æ
Branch Sales YoY = 
VAR CurrentSales = 
    CALCULATE(
        [Total Sales],
        FILTER(
            sales_performance,
            LOOKUPVALUE(employees[branch_id], employees[employee_id], sales_performance[employee_id]) = SELECTEDVALUE(branches[branch_id])
        )
    )
VAR PreviousSales = 
    CALCULATE(
        CurrentSales,
        SAMEPERIODLASTYEAR(sales_performance[transaction_date])
    )
RETURN
DIVIDE(CurrentSales - PreviousSales, PreviousSales, 0) * 100

// 16. åœ°åŸŸåˆ¥YoYåˆ†æ
Region Sales YoY = 
VAR SelectedRegion = SELECTEDVALUE(branches[region])
VAR CurrentSales = 
    CALCULATE(
        [Total Sales],
        FILTER(
            ALL(branches),
            branches[region] = SelectedRegion
        )
    )
VAR PreviousSales = 
    CALCULATE(
        CurrentSales,
        SAMEPERIODLASTYEAR(sales_performance[transaction_date])
    )
RETURN
DIVIDE(CurrentSales - PreviousSales, PreviousSales, 0) * 100
```

### **Advanced YoY Analysis**

```dax
// 17. ç§»å‹•å¹´é–“YoYï¼ˆRolling 12 monthsï¼‰
Sales Rolling 12M = 
CALCULATE(
    [Total Sales],
    DATESINPERIOD(
        sales_performance[transaction_date],
        MAX(sales_performance[transaction_date]),
        -12,
        MONTH
    )
)

Sales Rolling 12M Previous = 
CALCULATE(
    [Total Sales],
    DATESINPERIOD(
        sales_performance[transaction_date],
        DATEADD(MAX(sales_performance[transaction_date]), -12, MONTH),
        -12,
        MONTH
    )
)

Sales Rolling YoY Growth = 
DIVIDE([Sales Rolling 12M] - [Sales Rolling 12M Previous], [Sales Rolling 12M Previous], 0) * 100

// 18. YoYæˆé•·ç‡ã®å®‰å®šæ€§æŒ‡æ¨™
YoY Growth Stability = 
VAR Last12MonthsGrowth = 
    ADDCOLUMNS(
        SUMMARIZE(
            FILTER(
                ALL(sales_performance[transaction_date]),
                sales_performance[transaction_date] >= DATEADD(MAX(sales_performance[transaction_date]), -12, MONTH)
            ),
            YEAR(sales_performance[transaction_date]),
            MONTH(sales_performance[transaction_date])
        ),
        "MonthlyYoY", 
        CALCULATE([Sales YoY Growth Rate])
    )
VAR StandardDeviation = 
    STDEV.P([MonthlyYoY])
VAR AverageGrowth = 
    AVERAGE([MonthlyYoY])
RETURN
DIVIDE(StandardDeviation, ABS(AverageGrowth), 0)

// 19. YoYè²¢çŒ®åº¦åˆ†æ
YoY Contribution Analysis = 
VAR CurrentSales = [Total Sales]
VAR PreviousSales = [Sales Previous Year]
VAR TotalCurrentSales = CALCULATE([Total Sales], ALL())
VAR TotalPreviousSales = CALCULATE([Sales Previous Year], ALL())
VAR ProductContribution = (CurrentSales - PreviousSales)
VAR TotalContribution = (TotalCurrentSales - TotalPreviousSales)
RETURN
DIVIDE(ProductContribution, TotalContribution, 0) * 100
```

### **Display & Formatting Measures**

```dax
// 20. è¡¨ç¤ºç”¨ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆãƒ¡ã‚¸ãƒ£ãƒ¼
Sales YoY Display = 
VAR Growth = [Sales YoY Growth Rate]
RETURN
FORMAT(Growth, "+#,##0.0%;-#,##0.0%") 

Sales Growth Amount Display = 
VAR Amount = [Sales YoY Growth Amount]
RETURN
IF(Amount >= 0, "â–²", "â–¼") & FORMAT(ABS(Amount), "#,##0,,.0") & "å„„å††"

Sales Performance Indicator = 
VAR Growth = [Sales YoY Growth Rate]
RETURN
SWITCH(
    TRUE(),
    Growth > 20, "ğŸŸ¢ å„ªç§€",
    Growth > 10, "ğŸ”µ è‰¯å¥½",
    Growth > 0, "ğŸŸ¡ æ™®é€š",
    Growth > -10, "ğŸŸ  æ³¨æ„",
    "ğŸ”´ è¦æ”¹å–„"
)

Current vs Previous Display = 
"ä»Šå¹´: " & FORMAT([Total Sales], "#,##0,,.0") & "å„„å††" & UNICHAR(10) &
"å‰å¹´: " & FORMAT([Sales Previous Year], "#,##0,,.0") & "å„„å††" & UNICHAR(10) &
"æˆé•·: " & [Sales YoY Display]
```

### **Trend Analysis Measures**

```dax
// 24. ãƒˆãƒ¬ãƒ³ãƒ‰åˆ†æãƒ¡ã‚¸ãƒ£ãƒ¼
Sales Trend Direction = 
VAR Last3MonthsAvg = 
    CALCULATE(
        AVERAGEX(
            DATESINPERIOD(
                sales_performance[transaction_date],
                MAX(sales_performance[transaction_date]),
                -3,
                MONTH
            ),
            [Sales YoY Growth Rate]
        )
    )
VAR Previous3MonthsAvg = 
    CALCULATE(
        AVERAGEX(
            DATESINPERIOD(
                sales_performance[transaction_date],
                DATEADD(MAX(sales_performance[transaction_date]), -3, MONTH),
                -3,
                MONTH
            ),
            [Sales YoY Growth Rate]
        )
    )
RETURN
IF(Last3MonthsAvg > Previous3MonthsAvg, "æ”¹å–„å‚¾å‘", "æ‚ªåŒ–å‚¾å‘")

// 25. YoYãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚¹ã‚³ã‚¢
YoY Performance Score = 
VAR GrowthRate = [Sales YoY Growth Rate]
VAR GrowthStability = 1 / (1 + [YoY Growth Stability]) // å®‰å®šæ€§ãŒé«˜ã„ã»ã©é«˜ã‚¹ã‚³ã‚¢
VAR VolumeGrowth = DIVIDE([Transaction Count] - CALCULATE([Transaction Count], SAMEPERIODLASTYEAR(sales_performance[transaction_date])), CALCULATE([Transaction Count], SAMEPERIODLASTYEAR(sales_performance[transaction_date])), 0) * 100
RETURN
(GrowthRate * 0.5) + (GrowthStability * 20) + (VolumeGrowth * 0.3)
```

## ğŸ“Š **Power BI Visual Configuration**

### **YoY Sales Dashboard Layout**

**1. YoYã‚µãƒãƒªãƒ¼KPIã‚«ãƒ¼ãƒ‰**
- å€¤: `Sales YoY Display`, `Sales Growth Amount Display`, `Sales Performance Indicator`

**2. å£²ä¸ŠYoYãƒˆãƒ¬ãƒ³ãƒ‰ãƒãƒ£ãƒ¼ãƒˆ**
- **ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«å**: è¤‡åˆãƒãƒ£ãƒ¼ãƒˆ
- Xè»¸: `sales_performance[transaction_date]` (æœˆ)
- ä¸»è»¸: `Total Sales`, `Sales Previous Year`
- å‰¯è»¸: `Sales YoY Growth Rate`

**3. å•†å“ã‚«ãƒ†ã‚´ãƒªåˆ¥YoYæ¯”è¼ƒ**
- **ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«å**: æ°´å¹³æ£’ã‚°ãƒ©ãƒ•
- Yè»¸: å•†å“ã‚«ãƒ†ã‚´ãƒª
- Xè»¸: `Deposit Sales YoY`, `Loan Sales YoY`, `Investment Sales YoY`, `Insurance Sales YoY`

**4. åœ°åŸŸåˆ¥YoYãƒ’ãƒ¼ãƒˆãƒãƒƒãƒ—**
- **ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«å**: ãƒãƒˆãƒªãƒƒã‚¯ã‚¹
- è¡Œ: `branches[region]`
- å€¤: `Region Sales YoY`
- æ¡ä»¶ä»˜ãæ›¸å¼: ã‚°ãƒ©ãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³

**5. YoYè²¢çŒ®åº¦åˆ†æ**
- **ãƒ“ã‚¸ãƒ¥ã‚¢ãƒ«å**: ã‚¦ã‚©ãƒ¼ã‚¿ãƒ¼ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒ£ãƒ¼ãƒˆ
- ã‚«ãƒ†ã‚´ãƒª: å•†å“åˆ¥
- Yè»¸: `YoY Contribution Analysis`

ã“ã‚Œã‚‰ã®ãƒ¡ã‚¸ãƒ£ãƒ¼ã§åŒ…æ‹¬çš„ãªå£²ä¸ŠYoYåˆ†æãŒå¯èƒ½ã«ãªã‚Šã¾ã™ï¼
